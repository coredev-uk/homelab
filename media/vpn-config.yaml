#
# VPN Configuration for Tunnelled Applications
# Shared configuration for all gluetun sidecars
#
apiVersion: v1
kind: ConfigMap
metadata:
  name: vpn-config
  namespace: media
  labels:
    app: vpn
    component: config
data:
  # VPN provider and connection settings
  OUTBOUND_SUBNETS: "10.0.0.0/8,172.16.0.0/12,192.168.0.0/16"
  OUTBOUND_SUBNETS_PORTFORWARDED: "172.16.0.0/12,192.168.0.0/16"
  VPN_SERVICE_PROVIDER: "protonvpn"
  VPN_TYPE: "wireguard"
  SERVER_COUNTRIES: "United Kingdom,Switzerland,Netherlands"
  UPDATER_PERIOD: "24h"

  # Logging for troubleshooting
  LOG_LEVEL: "info"

---
#
# Gluetun Authentication Configuration
# Controls access to gluetun control servers for monitoring and management
#
apiVersion: v1
kind: ConfigMap
metadata:
  name: gluetun-auth-config
  namespace: media
  labels:
    app: vpn
    component: auth
data:
  config.toml: |
    # Glance dashboard access - read-only monitoring
    [[roles]]
    name = "glance"
    routes = [
      "GET /v1/publicip/ip",
      "GET /v1/openvpn/portforwarded"
    ]
    auth = "none"
